{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "track.schema.json",
  "title": "Track Types",
  "description": "Shared track types between App (TypeScript) and Analyzer (Python)",
  "definitions": {
    "DownloadStatus": {
      "type": "string",
      "enum": ["FreeDirectLink", "FreeExternalLink", "No"],
      "description": "Download availability status"
    },
    "TrackEntry": {
      "type": "object",
      "description": "Track entry as used in the frontend",
      "required": ["id", "urn", "permalink_url", "title", "artist", "duration"],
      "properties": {
        "id": { "type": "integer", "description": "SoundCloud ID" },
        "urn": { "type": "string" },
        "permalink_url": { "type": "string", "format": "uri" },
        "title": { "type": "string" },
        "artist": { "type": "string" },
        "artwork": { "type": ["string", "null"] },
        "duration": { "type": "integer", "description": "Duration in milliseconds" },
        "genre": { "type": ["string", "null"] },
        "description": { "type": ["string", "null"] },
        "created_at": { "type": ["string", "null"], "format": "date-time" },
        "label": { "type": ["string", "null"] },
        "tags": { "type": "array", "items": { "type": "string" } },
        "bpm_detected": { "type": ["number", "null"] },
        "bpm_confidence": { "type": ["number", "null"] },
        "key_detected": { "type": ["string", "null"] },
        "key_confidence": { "type": ["number", "null"] },
        "energy": { "type": ["number", "null"] },
        "loudness": { "type": ["number", "null"] },
        "dynamic_complexity": { "type": ["number", "null"] },
        "spectral_centroid": { "type": ["number", "null"] },
        "dissonance": { "type": ["number", "null"] },
        "danceability": { "type": ["number", "null"] },
        "speechiness": { "type": ["number", "null"] },
        "instrumentalness": { "type": ["number", "null"] },
        "acousticness": { "type": ["number", "null"] },
        "valence": { "type": ["number", "null"] },
        "liveness": { "type": ["number", "null"] },
        "analysis_status": { "$ref": "analysis.schema.json#/definitions/AnalysisStatus" },
        "analysis_error": { "type": ["string", "null"] },
        "analyzed_at": { "type": ["string", "null"], "format": "date-time" },
        "playback_count": { "type": "integer" },
        "likes_count": { "type": "integer" },
        "reposts_count": { "type": "integer" },
        "comment_count": { "type": "integer" },
        "downloadStatus": { "$ref": "#/definitions/DownloadStatus" },
        "downloadable": { "type": "boolean" },
        "purchase_url": { "type": ["string", "null"] },
        "purchase_title": { "type": ["string", "null"] }
      }
    },
    "DbTrack": {
      "type": "object",
      "description": "Database track record (snake_case matching Supabase schema)",
      "properties": {
        "soundcloud_id": { "type": "integer" },
        "urn": { "type": "string" },
        "permalink_url": { "type": "string" },
        "title": { "type": "string" },
        "artist": { "type": "string" },
        "artwork": { "type": ["string", "null"] },
        "duration": { "type": "integer" },
        "genre": { "type": ["string", "null"] },
        "description": { "type": ["string", "null"] },
        "soundcloud_created_at": { "type": ["string", "null"] },
        "label": { "type": ["string", "null"] },
        "tags": { "type": "array", "items": { "type": "string" } },
        "playback_count": { "type": "integer" },
        "likes_count": { "type": "integer" },
        "reposts_count": { "type": "integer" },
        "comment_count": { "type": "integer" },
        "download_status": { "type": "string" },
        "downloadable": { "type": "boolean" },
        "purchase_url": { "type": ["string", "null"] },
        "purchase_title": { "type": ["string", "null"] }
      }
    }
  }
}
