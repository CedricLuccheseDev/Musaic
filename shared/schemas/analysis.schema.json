{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "analysis.schema.json",
  "title": "Analysis Types",
  "description": "Shared analysis types between App (TypeScript) and Analyzer (Python)",
  "definitions": {
    "AnalysisStatus": {
      "type": "string",
      "enum": ["pending", "processing", "completed", "failed"],
      "description": "Status of track analysis"
    },
    "AnalysisResult": {
      "type": "object",
      "description": "Audio analysis results from Essentia",
      "required": [
        "bpm_detected", "bpm_confidence",
        "key_detected", "key_confidence",
        "energy", "loudness", "dynamic_complexity",
        "spectral_centroid", "dissonance",
        "danceability", "speechiness", "instrumentalness",
        "acousticness", "valence", "liveness",
        "highlight_time"
      ],
      "properties": {
        "bpm_detected": { "type": "number", "description": "Detected BPM" },
        "bpm_confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "key_detected": { "type": "string", "description": "Detected key (e.g., 'A minor')" },
        "key_confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "energy": { "type": "number", "minimum": 0, "maximum": 1 },
        "loudness": { "type": "number", "description": "Loudness in dB" },
        "dynamic_complexity": { "type": "number", "minimum": 0, "maximum": 1 },
        "spectral_centroid": { "type": "number", "description": "Brightness in Hz" },
        "dissonance": { "type": "number", "minimum": 0, "maximum": 1 },
        "danceability": { "type": "number", "minimum": 0, "maximum": 1 },
        "speechiness": { "type": "number", "minimum": 0, "maximum": 1 },
        "instrumentalness": { "type": "number", "minimum": 0, "maximum": 1 },
        "acousticness": { "type": "number", "minimum": 0, "maximum": 1 },
        "valence": { "type": "number", "minimum": 0, "maximum": 1, "description": "Mood/positivity" },
        "liveness": { "type": "number", "minimum": 0, "maximum": 1 },
        "highlight_time": { "type": "number", "description": "Timestamp of highlight in seconds" },
        "embedding": {
          "type": "array",
          "items": { "type": "number" },
          "description": "1280-dim vector from Discogs-Effnet"
        }
      }
    },
    "AnalyzeRequest": {
      "type": "object",
      "required": ["soundcloud_id"],
      "properties": {
        "soundcloud_id": { "type": "integer" }
      }
    },
    "BatchAnalysisRequest": {
      "type": "object",
      "properties": {
        "include_failed": { "type": "boolean", "default": false }
      }
    },
    "BatchStatusResponse": {
      "type": "object",
      "properties": {
        "is_running": { "type": "boolean" },
        "total_tracks": { "type": "integer" },
        "processed": { "type": "integer" },
        "successful": { "type": "integer" },
        "failed": { "type": "integer" },
        "current_track": { "type": ["string", "null"] }
      }
    },
    "HealthResponse": {
      "type": "object",
      "properties": {
        "status": { "type": "string", "enum": ["ok", "error"] },
        "queue_size": { "type": "integer" },
        "version": { "type": "string" }
      }
    }
  }
}
